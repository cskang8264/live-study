# 🛳🛳🛳Live-Study week1🛳🛳🛳
## **JVM은 무엇이며 자바 코드는 어떻게 실행하는 것인가?**
### JVM이란 무엇인가?
 - JVM 은 Java Virtual Machine의 약자로, Java와 OS 사이에 존재하는 가상머신이다. Java(*.java)파일을 실행하려면 아래 이미지와 같은 과정이 필요하다.

  ![javaToClass](https://media.vlpt.us/images/ggob_2/post/5fc85906-7d89-4894-b436-a6b537f36f54/KakaoTalk_20201117_010013529.jpg)

 **JVM의 역할**
 - **[Write once, run Anywhere]**
 OS에 자바파일을 실행하려면 class파일로 변환하여 실행하여야 한다. 이 때 각 OS에 맞는 class 파일로 컴파일(번역)을 해주는 것이 JVM의 역할이다.

 - **[Auto managing memory]**
 JVM은 메모리 관리에도 관여한다. GC(Garbage Collector)을 이용해 메모리를 관리한다. 사용자가 직접 메모리 관리를 안해줘도 된다.
```
메모리를 관리한다. -> 어떤 메모리를?  -> OS 레벨의 메모리 -> RAM?
C와 C++과의 비교 : C와 C++은 OS메모리에 직접 접근을 하여 free()라는 메소드를 호출하여 할당 받았던 메모리를 명시적으로 해제를 해주어야 된다. 그렇지 않으면 memory leak
(메모리누수 -> 해당 프로세스에 할당된 메모리를 반환하지 않고 계속 점유하고있어 더이상 할당될 메모리가 없는 상황)이 생겨 다른 프로그램에도 영향을 끼치게 된다.

반면 자바는 OS 메모리 영역에 직접적으로 접근하지 않고, JVM(C로 쓰여진 또 다른 프로그램이며 오브젝트가 필요해지지 않는 시점에서 알아서 free()를 실행하여 메모리를 확보)을 이용하여 간접적으로 접근한다.
웹어플리케이션을 만들 떄 모든 것을 다 직접 개발하여 쓰기보다 검증된 라이브러리나 프레임워크를 이용하는 것이 더 안전하고 편리한 것처럼, 메모리 관리라는 까다로운 부분을 자바 가상머신에 모두 맡겨버리는 것.
 -> 프로그램 실행시에 JVM 옵션을 주어서 OS에 요청한 사이즈 만큼의 메모리를 할당 받아서 실행하게된다. 할당받은 이상의 메모리를 사용하게 되면 에러가 나면서 자동으로 프로그램이 종료되어 다른 프로그램에는 영향을 주지 않게 된다.(JVM의 메모리 관리 프로세스)
 -> 편리하긴 하지만 성능적인 측면에서는 직접관리하는 경우가 더 나은 경우가 있다.
```
 **java를 사용하면 OS 레벨에서의 메모리누수는 발생하지 않는다**

### 컴파일 하는 방법
- 위의 이미지참고
```
Compile이란, 사용자가 작성한 코드를 컴퓨터가 이해할수있는 기계어로 번역하는 과정, target파일이 생성된다.(자바의 경우 *.class)
```

-Java는 JDK(Java Devalopment Kit)에 포함되어 있는 javac(자바컴파일러?)을 통해 컴파일 하며 아래와 같이 사용한다.(javac 을 정상적으로 사용하려면 **환경변수** 설정이 되어있어야한다.)

```
> javac <option> <filename.java>
```
컴파일이 완료되면, 목적파일인 <filename.class>가 생성된다.
목적파일을 이용해 코드를 실행할 수 있다. 

### 실행하는 방법 
컴파일을 통해 생성된 <filename.class>을 이용해 실행할 수 있다.

```
> java <filename>
```

  ![compile&run](https://media.vlpt.us/images/ggob_2/post/80a99155-69f6-44fb-8e7a-85ca76e17cc7/%EC%9E%90%EB%B0%94%20%EC%8B%A4%ED%96%89%EA%B3%BC%EC%A0%95.PNG)
  **java 코드의 실행 과정을 파악하는데 도움이된 블로그**
  (출처 : [https://javakong.tistory.com/132](https://javakong.tistory.com/132))


### javac options 
javac의 옵션에 대해 알아보자.

```
-classpath
``` 
: 컴파일러가 컴파일 과정 중 참조할 클래스 파일들을 찾기 위해 컴파일 시 **파일 경로**를 지정한다.
```
-d
``` 
: 클래스 파일을 생성할 **루트 디렉토리**를 지정한다.  (Default --> 소스파일이 위치한 디렉토리)
```
-encoding
```
: 소스 파일에 사용된 **문자열 인코딩**을 설정한다   (Default --> 플랫폼의 기본적인 인코딩 사용)
```
-g
```
: 모든 **디버깅 정보**를 생성시킨다.
```
-g:none
```
: 모든 **디버깅 정보**를 생성시키지 않는다.
```
-nowarn
```
: **경고메시지**를 생성시키지 않는다.
```
-verbose
```
: 컴파일러와 링커가 현재 어느 소스 파일이 컴파일 중인지, 링크 중인지에 대한 정보를 표시한다.
```
-deprecation
```
: 소스 코드내에서, 사용된 deprecated API의 위치를 출력한다.
```
-sourcepath
```
:소스파일의 위치를 지정한다.
```
-target
```
:지정된 자바버전의 가상머신에서 작동 되도록 클래스파일을 생성한다.

``` java
> javac -target 1.2 Helloworld.java
```
```
-bootclasspath (path)
```
:특정한 bootstrap or 확장 클래스를 지정한다.
cross-compile을 가능하게 한다. (주로 모바일, 임베디드 에서 사용한다) 크로스컴파일이 뭔데..? -> 크로스 컴파일러는 컴파일은 컴퓨터에서 가능하지만 실행 자체를 다른 곳(ex 임베디드 시스템)
```
-extdirs (디렉터리)
```
: 특정한, 확장 디렉터리를 지정한다.
cross-compile에서 주로 사용하며  ```:```을 통해 디렉터리를 구분한다. 

### 바이트 코드란 무엇인가?

-바이트코드의 일반적인 정의는 다음과 같다.

``` java
바이트코드(byte code)는 특정 하드웨어가 아닌 가상 머신에서의 실행 프로그램을 위한 이진 표현법으로, 
하드웨어가 아닌 소프트웨어에 의해 처리되기 때문에, 보통 기계어보다 더 추상적이다.
```
Java에서의 바이트 코드는, 자바 가상머신(JVM)이 이해할 수 있는 언어로 변환된 자바 소스 코드를 의미한다.

자바 컴파일러에 의해 변환되는 코드의 명령어 크기가 **1바이트**라서 자바 바이트 코드라고 불리며, 자바 바이트 코드의 확장자는 ```.class```다.

자바 바이트 코드는 자바 가상 머신만 설치되어 있으면, 어떤 운영체제에서라도 실행될 수 있다. 

### JIT 컴파일러란 무엇이며, 어떻게 동작하는가 
